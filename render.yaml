services:
  - type: web
    name: nexusk-forum
    env: docker
    plan: free
    dockerfilePath: ./Dockerfile
    healthCheck:
      tcp: true
      initialDelaySeconds: 60
      periodSeconds: 30
    envVars:
      - key: FORUM_URL
        value: https://nexusk-forum.onrender.com
      - key: DB_HOST
        fromDatabase:
          name: nexusk-database
          property: host
      - key: DB_NAME
        fromDatabase:
          name: nexusk-database
          property: database
      - key: DB_USER
        fromDatabase:
          name: nexusk-database
          property: user
      - key: DB_PASS
        fromDatabase:
          name: nexusk-database
          property: password
      - key: FLARUM_ADMIN_USER
        value: admin
      - key: FLARUM_ADMIN_PASS
        value: nexusk2025
      - key: FLARUM_ADMIN_MAIL
        value: admin@nexusk.com
      - key: FLARUM_TITLE
        value: NexusK 服务器论坛
      - key: TZ
        value: Asia/Shanghai

databases:
  # 关键修改：将数据库类型明确指定为 MySQL
  - name: nexusk-database
    databaseName: nexusk
    plan: free
    # 添加这一行来指定使用 MySQL 8
    databaseEngine: MYSQL_8